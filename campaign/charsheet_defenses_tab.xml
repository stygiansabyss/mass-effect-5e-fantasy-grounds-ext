<?xml version="1.0" encoding="iso-8859-1"?>
<root>
    <!-- Add Defenses Tab to Character Sheet -->
    <windowclass name="charsheet" merge="join">
        <script>
            function onInit()
                local tTabs = WindowTabManager.getTabsFromWindow(self);
                
                WindowTabManager.registerTab('charsheet', {
                    sName = 'defenses', 
                    sTabRes = 'tab_defenses',
                    sClass = 'charsheet_defenses', 
                    sInsertBefore = 'actions'
                })
                
                WindowTabManager.updateTabDisplay(self, tTabs);
                
                if super and super.onInit then
                    super.onInit();
                end
            end
        </script>
    </windowclass>
    
    <!-- Define the tab container -->
    <windowclass name="charsheet_defenses">
        <sheetdata>
            <anchor_content_top />
            <anchor_content_bottom />
            <sub_content_framed_groupbox name="content">
                <class>charsheet_defenses_contents</class>
            </sub_content_framed_groupbox>
            <scrollbar_content />
        </sheetdata>
    </windowclass>

    <!-- Defenses Tab Content -->
    <windowclass name="charsheet_defenses_contents">
        <!-- ME5e Defenses section - positioned above weapons -->
        <margins control="0,0,0,2" />
        <script file="campaign/scripts/charsheet_defenses_tab.lua" />
        <sheetdata>
            <anchor_content_top />
            
            <label_charframetop name="defenses_title">
                <anchored to="contentanchor" height="20">
                    <top relation="relative" offset="2" postoffset="2" />
					<left offset="10" />
					<right offset="-10" />
                </anchored>
                <static text="Mass Effect Defenses" />
            </label_charframetop>
            
            <!-- Barrier Section -->
            <label_charframetop name="barrier_title">
                <anchored to="defenses_title" position="below" offset="0,10">
                    <top relation="relative" offset="10" postoffset="10" />
					<left offset="0" />
					<right offset="0" />
                </anchored>
                <static text="Biotic Barrier" />
            </label_charframetop>
            
            <label name="barrier_uses_label">
                <anchored to="barrier_title" position="below" width="200" offset="0,10">
                    <left offset="0" />
                </anchored>
                <static text="Barrier Uses:" />
            </label>
            
            <!-- Dynamic Barrier Use Labels (max 10) -->
            <label name="barrier_use_1">
                <anchored to="barrier_uses_label" position="below" width="15" height="15" offset="0,5">
                    <left offset="0" />
                </anchored>
                <static text="□" />
                <tooltip text="Click to toggle barrier use" />
                <script>
                    function onClickDown()
                        return true;
                    end
                    function onClickRelease()
                        window.toggleBarrierUse(1);
                    end
                </script>
            </label>
            <label name="barrier_use_2">
                <anchored to="barrier_use_1" position="right" offset="-100,0" width="15" height="15">
                    <left offset="10" />
                </anchored>
                <static text="□" />
                <tooltip text="Click to toggle barrier use" />
                <script>
                    function onClickDown()
                        return true;
                    end
                    function onClickRelease()
                        window.toggleBarrierUse(2);
                    end
                </script>
            </label>
            <label name="barrier_use_3">
                <anchored to="barrier_use_2" position="right" offset="2,0" width="15" height="15">
                    <left offset="10" />
                </anchored>
                <static text="□" />
                <tooltip text="Click to toggle barrier use" />
                <script>
                    function onClickDown()
                        return true;
                    end
                    function onClickRelease()
                        window.toggleBarrierUse(3);
                    end
                </script>
            </label>
            <label name="barrier_use_4">
                <anchored to="barrier_use_3" position="right" offset="2,0" width="15" height="15">
                    <left offset="10" />
                </anchored>
                <static text="□" />
                <tooltip text="Click to toggle barrier use" />
                <script>
                    function onClickDown()
                        return true;
                    end
                    function onClickRelease()
                        window.toggleBarrierUse(4);
                    end
                </script>
            </label>
            <label name="barrier_use_5">
                <anchored to="barrier_use_4" position="right" offset="2,0" width="15" height="15">
                    <left offset="10" />
                </anchored>
                <static text="□" />
                <tooltip text="Click to toggle barrier use" />
                <script>
                    function onClickDown()
                        return true;
                    end
                    function onClickRelease()
                        window.toggleBarrierUse(5);
                    end
                </script>
            </label>
            <label name="barrier_use_6">
                <anchored to="barrier_use_5" position="right" offset="2,0" width="15" height="15">
                    <left offset="10" />
                </anchored>
                <static text="□" />
                <tooltip text="Click to toggle barrier use" />
                <script>
                    function onClickDown()
                        return true;
                    end
                    function onClickRelease()
                        window.toggleBarrierUse(6);
                    end
                </script>
            </label>
            <label name="barrier_use_7">
                <anchored to="barrier_use_6" position="right" offset="2,0" width="15" height="15">
                    <left offset="10" />
                </anchored>
                <static text="□" />
                <tooltip text="Click to toggle barrier use" />
                <script>
                    function onClickDown()
                        return true;
                    end
                    function onClickRelease()
                        window.toggleBarrierUse(7);
                    end
                </script>
            </label>
            <label name="barrier_use_8">
                <anchored to="barrier_use_7" position="right" offset="2,0" width="15" height="15">
                    <left offset="10" />
                </anchored>
                <static text="□" />
                <tooltip text="Click to toggle barrier use" />
                <script>
                    function onClickDown()
                        return true;
                    end
                    function onClickRelease()
                        window.toggleBarrierUse(8);
                    end
                </script>
            </label>
            <label name="barrier_use_9">
                <anchored to="barrier_use_8" position="right" offset="2,0" width="15" height="15">
                    <left offset="10" />
                </anchored>
                <static text="□" />
                <tooltip text="Click to toggle barrier use" />
                <script>
                    function onClickDown()
                        return true;
                    end
                    function onClickRelease()
                        window.toggleBarrierUse(9);
                    end
                </script>
            </label>
            <label name="barrier_use_10">
                <anchored to="barrier_use_9" position="right" offset="2,0" width="15" height="15">
                    <left offset="10" />
                </anchored>
                <static text="□" />
                <tooltip text="Click to toggle barrier use" />
                <script>
                    function onClickDown()
                        return true;
                    end
                    function onClickRelease()
                        window.toggleBarrierUse(10);
                    end
                </script>
            </label>
            
            <label name="barrier_activate_test">
                <anchored to="barrier_use_1" position="below" offset="0,10" height="20" width="120">
                    <left offset="0" />
                </anchored>
                <static text="[Activate Barrier]" />
                <tooltip text="Click to activate barrier" />
                <script>
                    function onClickDown()
                        return true;
                    end
                    function onClickRelease()
                        window.activateBarrierFromXML();
                    end
                </script>
            </label>
            
            <label name="barrier_ticks_display">
                <anchored to="barrier_activate_test" position="right" offset="10,0" height="20" width="150">
                    <left offset="105" />
                </anchored>
                <static text="Grants: 0 ticks" />
            </label>
            
            <!-- Tech Armor Section -->
            <label_charframetop name="techarmor_title">
                <anchored to="barrier_activate_test" position="below" offset="0,20">
                    <left offset="0" />
                    <right offset="0" />
                </anchored>
                <static text="Tech Armor" />
            </label_charframetop>
            
            <label name="techarmor_uses_label">
                <anchored to="techarmor_title" position="below" width="200" offset="0,10">
                    <left offset="0" />
                </anchored>
                <static text="Tech Armor Uses:" />
            </label>
            
            <!-- Tech Armor Use Labels (max 2) -->
            <label name="techarmor_use_1">
                <anchored to="techarmor_uses_label" position="below" width="15" height="15" offset="0,5">
                    <left offset="0" />
                </anchored>
                <static text="□" />
                <tooltip text="Click to toggle tech armor use" />
                <script>
                    function onClickDown()
                        return true;
                    end
                    function onClickRelease()
                        window.toggleTechArmorUse(1);
                    end
                </script>
            </label>
            <label name="techarmor_use_2">
                <anchored to="techarmor_use_1" position="right" offset="2,0" width="15" height="15">
                    <left offset="10" />
                </anchored>
                <static text="□" />
                <tooltip text="Click to toggle tech armor use" />
                <script>
                    function onClickDown()
                        return true;
                    end
                    function onClickRelease()
                        window.toggleTechArmorUse(2);
                    end
                </script>
            </label>
            
            <label name="techarmor_activate_test">
                <anchored to="techarmor_use_1" position="below" offset="0,10" height="20" width="120">
                    <left offset="0" />
                </anchored>
                <static text="[Activate Tech Armor]" />
                <tooltip text="Click to activate tech armor" />
                <script>
                    function onClickDown()
                        return true;
                    end
                    function onClickRelease()
                        window.activateTechArmorFromXML();
                    end
                </script>
            </label>
            
            <label name="techarmor_hp_display">
                <anchored to="techarmor_activate_test" position="right" offset="10,0" height="20" width="150">
                    <left offset="133" />
                </anchored>
                <static text="Grants: 0 HP" />
            </label>
            
            <!-- Kinetic Shields Section -->
            <label_charframetop name="shields_title">
                <anchored to="techarmor_hp_display" position="below" offset="0,20">
                    <left offset="-133" />
                    <right offset="190" />
                </anchored>
                <static text="Kinetic Shields" />
            </label_charframetop>
            
            <!-- Shield Stats Display -->
            <label name="shields_stats_label">
                <anchored to="shields_title" position="below" width="200" offset="0,10">
                    <left offset="0" />
                </anchored>
                <static text="Shield Stats:" />
            </label>
            
            <label name="shields_max_display">
                <anchored to="shields_stats_label" position="below" width="150" offset="0,5">
                    <left offset="0" />
                </anchored>
                <static text="Max: 0" />
            </label>
            
            <label name="shields_regen_display">
                <anchored to="shields_max_display" position="right" width="150" offset="0,5">
                    <left offset="100" />
                </anchored>
                <static text="Regen: 0" />
            </label>
            
            <!-- Shield Controls -->
            <label name="shields_controls_label">
                <anchored to="shields_max_display" position="below" width="200" offset="0,15">
                    <left offset="0" />
                </anchored>
                <static text="Shield Controls:" />
            </label>
            
            <label name="shields_add_regen">
                <anchored to="shields_controls_label" position="below" width="120" height="20" offset="0,10">
                    <left offset="0" />
                </anchored>
                <static text="[Add Regen]" />
                <tooltip text="Add regeneration amount to current shields" />
                <script>
                    function onClickDown()
                        return true;
                    end
                    function onClickRelease()
                        window.addShieldRegen();
                    end
                </script>
            </label>
            
            <label name="shields_set_max">
                <anchored to="shields_add_regen" position="right" width="120" height="20" offset="0,5">
                    <left offset="130" />
                </anchored>
                <static text="[Set to Max]" />
                <tooltip text="Set shields to maximum value" />
                <script>
                    function onClickDown()
                        return true;
                    end
                    function onClickRelease()
                        window.setShieldsToMax();
                    end
                </script>
            </label>
            
        </sheetdata>
    </windowclass>
</root>